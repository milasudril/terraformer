\documentclass[a4paper, 11pt]{scrartcl}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[intlimits]{amsmath}
\usepackage{fixme}


\title{Limits of spline derivatives}
\author{Torbj√∂rn Rathsman}

\begin{document}
\maketitle

With $x\in[0, 1]$

\[
\left\{
\begin{aligned}
 y(x) &= Ax^3 + Bx^2 + Cx + D\\
 y(0) &= 1\\
 y(1) &= 0\\
 y^\prime(0) &= a \\
 y^\prime(1) &= b \\
\end{aligned}
\right.
\iff
\left\{
\begin{aligned}
3Ax^2 + 2Bx + C &= y^\prime(x)\\
D &= 1 \\
A + B + C + D &= 0 \\
C &= a \\
3A + 2B + C &= b
\end{aligned}
\right.
\]
\[
 \left\{
\begin{aligned}
A + B + C + D &= 0 \\
3A + 2B + C &= b \\
C &= a \\
D &= 1
\end{aligned}
\right.
\iff
\left\{
\begin{aligned}
A&=b+a+2\\
B&=-b-2a-3\\
C&=a\\
D&=1
\end{aligned}
\right.
\]

Now solve
\[
 3Ax^2 + 2Bx + C < 0
\]

\paragraph{Case $A=B=0$}
If $A = B = 0$, the curve is a straight line, and thus always monotonic. To satisfy boundary conditions, $a = b = -1$. This is also consistent with the equations for $A$ and $B$, since $-2 - 2 + 2 = 0$, and $1 + 3 - 3 = 0$. To conclude, $a = b = -1$ is a valid solution.

\paragraph{Case $A=0\land B\neq 0$}
In this case $2Bx + C = -2\left(b + 2a + 3\right)x + a < 0$, since $A = 0$, $b = -(2 + a)$, which implies that $-2\left(b + 2a + 3\right)x + a = -2\left(a + 1\right)x + a < 0$.

First, assume that $a < -1$. In this case, the range of $x$ requires that $2k + a < 0$, where $k = -(a + 1) > 0$. This is true if and only if $a < -2k = 2(a + 1)$, which is false for all $a$. Thus $a < -1$ is invalid.

Now, assume that $a > -1$. In this case, the range of $x$ requires that $a < 0$, which is trivial.

To conclude, $a\in[-1, 0] \iff b\in[-2, -1]$.


\paragraph{The general case}
In the general case,
\[
x^2 +\frac{2B}{3A}x + \frac{C}{3A} < 0
\]
By completing the square,
\[
 \left(x - \frac{B}{3A}\right)^2 - \left(\frac{B}{3A}\right)^2 + \frac{C}{3A} < 0 \iff \left(x - \frac{B}{3A}\right)^2  < \left(\frac{B}{3A}\right)^2 - \frac{C}{3A}
\]
provided that
\[
\left(\frac{B}{3A}\right)^2 - \frac{C}{3A} > 0
\]

First, assume that $\frac{B}{3A} > 0$. Then, the range of $x$ requires that
\[
3A + 2B + C < 0
\]

Now, assume that $\frac{B}{3A} < 0$. Then, the range of $x$ requires that
\[
 C < 0
\]

\end{document}$